function setRealContentHeight(){var e=$.mobile.activePage.find("div[data-role='header']:visible"),i=$.mobile.activePage.find("div[data-role='footer']:visible"),t=$.mobile.activePage.find("div.ui-content:visible:visible"),n=$(window).height(),s=n-(e.outerHeight()-1)-(i.outerHeight()-1);t.outerHeight()-e.outerHeight()-i.outerHeight()<=n&&(s-=t.outerHeight()-t.height()),$(".ui-content").height(s)}function get_classement(e,i,t){var n=urls.classement[e],s="";$.each(divisions,function(i,t){t.nom==e&&(s=t)}),""==s&&(i=!0,s={nom:e,equipes:[]},divisions.push(s));var a="";$("#page_classement h1").html("Classement "+e);var o=$("#page_classement .classement tbody");o.empty(),i?(s.equipes=[],$.get(n,function(e){var i=0,n=$(e).find(".classement tbody tr");n.each(function(){var e=$(this);a={},$scores=e.find("td"),a.nom=$($scores[0]).text(),a.joue=$($scores[1]).text(),a.gagne=$($scores[2]).text(),a.egalite=$($scores[3]).text(),a.perdu=$($scores[4]).text(),a.marques=$($scores[5]).text(),a.encaisses=$($scores[6]).text(),a.difference=$($scores[7]).text(),a.points=$($scores[8]).text(),a.link=$($scores[0]).find("a").attr("href"),s.equipes.push(a),o.append("<tr class='equipe'><td><a href='#' class='equipe_link' data-url='"+a.link+"' data-nom='"+a.nom+"'>"+a.nom+"</a></td><td>"+a.joue+"</td><td>"+a.gagne+"</td><td>"+a.egalite+"</td><td>"+a.perdu+"</td><td>"+a.marques+"</td><td>"+a.encaisses+"</td><td>"+a.difference+"</td><td>"+a.points+"</td></tr>")}),division_now=s,t(s.equipes)})):($.each(s.equipes,function(e,i){o.append("<tr class='equipe'><td><a href='#' class='equipe_link' data-url='"+i.link+"' data-nom='"+i.nom+"'>"+i.nom+"</a></td><td>"+i.joue+"</td><td>"+i.gagne+"</td><td>"+i.egalite+"</td><td>"+i.perdu+"</td><td>"+i.marques+"</td><td>"+i.encaisses+"</td><td>"+i.difference+"</td><td>"+i.points+"</td></tr>")}),division_now=s,t(s.equipes))}function get_equipe(e,i,t,n){var s="";Array.isArray(division_now.equipes)&&$.each(division_now.equipes,function(i,t){t.nom==e&&(s=t)}),""==s?(i=!0,s={nom:e,link:t,joueurs:[]},Array.isArray(division_now.equipes)&&division_now.equipes.push(s)):Array.isArray(s.joueurs)||(i=!0,s.joueurs=[]),$("#page_equipe h1").html(e);var a=$("#joueurs");a.empty(),i?(s.joueurs=[],$.get(t,function(e){var i=0,t=$(e).find(".player-row");t.each(function(){var e=$(this),i={};i.numero=e.find(".shirt-num").text(),i.nom=e.find(".container-player-row a").text(),i.place=e.find(".container-player-row div").text(),i.link=e.find(".container-player-row a").prop("href"),s.joueurs.push(i),a.append("<li><a href='#' class='joueur_link' data-url='"+i.link+"' data-nom=\""+i.nom+'">#'+i.numero+" "+i.nom+"</a></li>")}),equipe_now=s,n(s.joueurs)})):($.each(s.joueurs,function(e,i){a.append("<li><a href='#' class='joueur_link' data-url='"+i.link+"' data-nom=\""+i.nom+'">#'+i.numero+" "+i.nom+"</a></li>")}),equipe_now=s,n(s.joueurs))}function get_joueur(e,i,t,n){var s="";Array.isArray(equipe_now.joueurs)&&$.each(equipe_now.joueurs,function(i,t){t.nom==e&&(s=t)}),""==s?(i=!0,s={nom:e},Array.isArray(equipe_now.joueurs)&&equipe_now.joueurs.push(s)):void 0==s.joues&&(i=!0),$("#page_joueur h1").html(e);var a=$("#joueur");a.empty(),i?$.get(t,function(i){var t=0,o=$(i).find(".season-stats li");s.nom=e,s.joues=$(o[0]),s.gagnes=$(o[1]),s.perdus=$(o[2]),s.goals=$(o[3]),s.assists=$(o[4]),s.points=$(o[5]),s.joues.find("label").remove(),s.gagnes.find("label").remove(),s.perdus.find("label").remove(),s.goals.find("label").remove(),s.assists.find("label").remove(),s.points.find("label").remove(),s.joues=s.joues.text(),s.gagnes=s.gagnes.text(),s.perdus=s.perdus.text(),s.goals=s.goals.text(),s.assists=s.assists.text(),s.points=s.points.text(),a.append("<li><span>Matchs joués</span><span class='ul-li-count'>"+s.joues+"</span></li>"),a.append("<li><span>Matchs gagnés</span><span class='ul-li-count'>"+s.gagnes+"</span></li>"),a.append("<li><span>Matchs perdus</span><span class='ul-li-count'>"+s.perdus+"</span></li>"),a.append("<li><span>Goals</span><span class='ul-li-count'>"+s.goals+"</span></li>"),a.append("<li><span>Assists</span><span class='ul-li-count'>"+s.assists+"</span></li>"),a.append("<li><span>Points</span><span class='ul-li-count'>"+s.points+"</span></li>"),n(s),joueur_now=s}):(a.append("<li><span>Matchs joués</span><span class='ul-li-count'>"+s.joues+"</span></li>"),a.append("<li><span>Matchs gagnés</span><span class='ul-li-count'>"+s.gagnes+"</span></li>"),a.append("<li><span>Matchs perdus</span><span class='ul-li-count'>"+s.perdus+"</span></li>"),a.append("<li><span>Goals</span><span class='ul-li-count'>"+s.goals+"</span></li>"),a.append("<li><span>Assists</span><span class='ul-li-count'>"+s.assists+"</span></li>"),a.append("<li><span>Points</span><span class='ul-li-count'>"+s.points+"</span></li>"),n(s),joueur_now=s)}function get_match_du_jour(e,i){var t=$("#matchs_live");t.empty(),$.get(e,function(e){var n=0,s=$(e).find(".match-live li");if(s.length>0){var a="",o="",l="",u="",d="",p="",r="",c="";s.each(function(){$match=$(this),division="<h2 class='match_division'>"+$match.find(".div-name").html()+"</h2>",a=$match.find(".first-games-teams"),o=$(a[0]).find("img"),l=o.attr("src"),o=o.attr("title"),equipe1_el="<img src='"+l+"' alt=\""+o+"\" class='match_equipe' />",u=$(a[1]).find("img"),d=u.attr("src"),u=u.attr("title"),equipe2_el="<img src='"+d+"' alt=\""+u+"\" class='match_equipe' />",c="<div class='match_date'>"+$match.find(".dateandtime").html()+"</div>",p=$match.find(".score-live"),p=p.length>0?"<div class='match_score'>"+$(p[0]).html()+" - "+$(p[1]).html()+"</div>":"<div class='match_score'>pas débuté</div>",r=$match.find(".score-games-teams a").attr("href");var e=$("<li/>");e.data("url",r),e.append(division),e.append(c),e.append(equipe1_el),e.append(p),e.append(equipe2_el),e.append("<div class='match_equipe_texte'><strong>"+o+"</strong> vs <strong>"+u+"</strong></div>"),t.append(e)})}else t.append("<div>Pas de match aujourd'hui</div>");i()})}function get_calendrier(e,i){var t=$("#calendrier");t.empty(),$.get(e,function(e){var n=0,s=$(e).find(".resul");if(s.length>0){var a="",o="",l="",u="",d="",p="",r="",c="",m="",h="";s.each(function(){$match=$(this),division=$match.find(".first label"),division.find("a").remove(),division="<h2 class='match_division'>"+division.text(),a=$match.find(".tree-block"),o=a.find(".first-block"),l=o.find("img").attr("src"),u=o.find("label a").attr("href"),o=o.find("label a").text(),equipe1_el="<img src='"+l+"' alt=\""+o+"\" class='match_equipe' data-url='"+u+"' />",d=a.find(".td-block"),p=d.find("img").attr("src"),r=d.find("label a").attr("href"),d=d.find("label a").text(),equipe2_el="<img src='"+p+"' alt=\""+d+"\" class='match_equipe' data-url='"+r+"' />",h="<div class='match_date'>"+$match.find(".resul-date").html()+"</div>";var e=$("<li/>");e.append(division),e.append(h),e.append(equipe1_el),e.append("<span class='vs'>vs</span>"),e.append(equipe2_el),e.append("<div class='match_equipe_texte'><strong>"+o+"</strong> vs <strong>"+d+"</strong></div>"),t.append(e)})}else t.append("<div>Plus de match à jouer</div>");i()})}function init(){$(document).on("pageshow",setRealContentHeight),$(document).on("pageshow",function(){$(".nav-menu").load("menu.html",function(){$(".nav-menu").panel(),$(".nav-menu ul").listview(),$(".nav-menu").trigger("updatelayout")})}),$(document).on("click",".nav-menu a.page_divisions",function(){$("#page_divisions h1").text("Classement"),$("#page_divisions").trigger("updatelayout"),$(".nav-menu").panel("close")}),$(document).on("click",".division",function(){$.mobile.loading("show",{text:"Chargement...",textVisible:!0,theme:"b",textonly:!1,html:""}),get_classement($(this).data("division"),!1,function(){document.location="#page_classement",$.mobile.loading("hide")})}),$(document).on("click",".equipe_link",function(){$.mobile.loading("show",{text:"Chargement...",textVisible:!0,theme:"b",textonly:!1,html:""}),get_equipe($(this).data("nom"),!1,$(this).data("url"),function(){document.location="#page_equipe",$("#page_equipe .joueurs").listview("refresh"),$.mobile.loading("hide")})}),$(document).on("click",".joueur_link",function(){$.mobile.loading("show",{text:"Chargement...",textVisible:!0,theme:"b",textonly:!1,html:""}),get_joueur($(this).data("nom"),!1,$(this).data("url"),function(){document.location="#page_joueur",$("#joueur").listview({splitTheme:"b"}),$("#joueur").listview("refresh"),$.mobile.loading("hide")})}),$(document).on("click","#page_classement .refresh",function(){$.mobile.loading("show",{text:"Chargement...",textVisible:!0,theme:"b",textonly:!1,html:""}),get_classement(division_now.nom,!0,function(){$.mobile.loading("hide")})}),$(document).on("click","#page_equipe .refresh",function(){$.mobile.loading("show",{text:"Chargement...",textVisible:!0,theme:"b",textonly:!1,html:""}),get_equipe(equipe_now.nom,!0,equipe_now.link,function(){$("#page_equipe .joueurs").listview("refresh"),$.mobile.loading("hide")})}),$(document).on("click",".nav-menu a.page_matchs_live",function(){$.mobile.loading("show",{text:"Chargement...",textVisible:!0,theme:"b",textonly:!1,html:""}),get_match_du_jour("http://www.fshbr.ch/",function(){$("#page_matchs_live .matchs_live").listview("refresh"),$.mobile.loading("hide")})}),$(document).on("click",".nav-menu a.page_calendrier",function(){$("#page_divisions h1").text("Calendrier"),$("#page_divisions").trigger("updatelayout"),$(".nav-menu").panel("close")})}function log(e){$(".console").append("<div>"+e+"</div>")}var urls={classement:{d1:"http://www.fshbr.ch/competitions/index/1",d2:"http://www.fshbr.ch/competitions/index/2",d3a:"http://www.fshbr.ch/competitions/index/3",d3b:"http://www.fshbr.ch/competitions/index/4",juniors:"http://www.fshbr.ch/competitions/index/5",novices:"http://www.fshbr.ch/competitions/index/6",minis:"http://www.fshbr.ch/competitions/index/7"}},divisions=[],division_now="",equipe_now="",joueur_now="";