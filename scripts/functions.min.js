function setRealContentHeight(){var e=$.mobile.activePage.find("div[data-role='header']:visible"),t=$.mobile.activePage.find("div[data-role='footer']:visible"),i=$.mobile.activePage.find("div.ui-content:visible:visible"),a=$(window).height(),n=a-(e.outerHeight()-1)-(t.outerHeight()-1);i.outerHeight()-e.outerHeight()-t.outerHeight()<=a&&(n-=i.outerHeight()-i.height()),$(".ui-content").height(n)}function get_rss(e,t){var i="",a="",n=[],o=[],r=0,c="",h="",s=[];$.get(e,function(e){$(e).find("item").each(function(){var e=$(this);i=e.find("title").text().replace("<![CDATA[","").replace("]]>","").split(" | "),a=i[0].trim(),-1==n.indexOf(a)&&(r=n.push(a)-1,o[r]=[]),c=e.find("description").text().replace("<![CDATA[","").replace("]]>",""),h=e.find("comments").text().replace("<![CDATA[","").replace("]]>",""),o[r].push({heure:i[1],titre:i[2],description:c,commentaires:h})}),$.each(n,function(e,t){s.push({nom:t,programme:o[e]})}),t(s)})}function affiche_chaines(e,t){return 0==t.length?!1:($.each(e,function(e,i){t.append("<li><a href='#' data-chaineindex='"+e+"' class='chaine'>"+i.nom+"</a></li>")}),void $("#chaines .chaine").on("click",function(t){t.stopPropagation(),t.preventDefault();var i=$(this).data("chaineindex"),a=e[i];$("#page_chaine_programme .titre_chaine").html(a.nom),$("#page_chaine_programme .programme_chaine").empty(),$.each(a.programme,function(e,t){$contenu=$('<div class="programme"><div class="ui-corner-all custom-corners"><div class="ui-bar ui-bar-a"><h3>'+t.heure+" - "+t.titre+'</h3></div><div class="ui-body ui-body-a"><p>'+t.description+'</p><div><a href="#" class="share" data-sharetitle="'+t.titre+'" data-sharetext="'+t.description+'"><i class="fa fa-share-alt" style="font-size: 2.5em; color: #000;"></i></a></div></div></div></div>'),$("#page_chaine_programme .programme_chaine").append($contenu)}),document.location="#page_chaine_programme"}))}function init(){$(document).on("pageshow",setRealContentHeight),$(document).on("deviceready",function(){}),$(document).on("pageshow",function(){$(".nav-menu").load("menu.html",function(){$(".nav-menu").panel(),$(".nav-menu").trigger("updatelayout")})}),$(document).on("click","button.refresh",function(){$.mobile.loading("show",{text:"Chargement du programme TV",textVisible:!0,theme:"b",textonly:!1,html:""}),get_rss(rss,function(e){var t={date:date,programme:e};localStorage.setItem("programmetv",JSON.stringify(t)),$("#chaines").empty(),affiche_chaines(t.programme,$("#chaines")),$("#chaines").listview("refresh"),$.mobile.loading("hide"),navigator.vibrate(1e3)})}),$(document).on("click",".share",function(e){e.stopPropagation(),e.preventDefault();var t=$(this).data("sharetitle"),i=$(this).data("sharetext");navigator.share(i,t)})}